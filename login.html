<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xyaa Tools Track</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #000;
            color: #fff;
            position: relative;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        /* Purple neon grid animation */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(rgba(138, 43, 226, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(138, 43, 226, 0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            animation: gridMove 60s linear infinite;
            z-index: -1;
        }
        
        @keyframes gridMove {
            0% {
                background-position: 0 0;
            }
            100% {
                background-position: 1000px 1000px;
            }
        }
        
        /* Neon glow effect */
        .login-form, .visitor-card {
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.7), 
                        0 0 20px rgba(138, 43, 226, 0.5),
                        0 0 30px rgba(138, 43, 226, 0.3);
            animation: neonGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes neonGlow {
            from {
                box-shadow: 0 0 5px rgba(138, 43, 226, 0.7), 
                            0 0 10px rgba(138, 43, 226, 0.5),
                            0 0 15px rgba(138, 43, 226, 0.3);
            }
            to {
                box-shadow: 0 0 10px rgba(138, 43, 226, 0.7), 
                            0 0 20px rgba(138, 43, 226, 0.5),
                            0 0 30px rgba(138, 43, 226, 0.3);
            }
        }
        
        .login-form { 
            background: rgba(20, 20, 20, 0.8); 
            padding: 20px; 
            border-radius: 10px;
            max-width: 400px; 
            margin: 50px auto;
            border: 1px solid #8a2be2;
        }
        
        h2 {
            color: #8a2be2;
            text-align: center;
            text-shadow: 0 0 5px #8a2be2;
        }
        
        input { 
            padding: 10px; 
            margin: 8px 0; 
            width: 100%; 
            background: rgba(30, 30, 30, 0.8);
            border: 1px solid #8a2be2;
            border-radius: 4px; 
            color: white;
        }
        
        button { 
            padding: 10px 15px; 
            background: #8a2be2; 
            color: white; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
            width: 100%;
            font-weight: bold;
            transition: all 0.3s;
            margin: 5px 0;
        }
        
        button:hover {
            background: #9932cc;
            box-shadow: 0 0 10px #8a2be2;
        }
        
        .error { 
            color: #ff5555; 
            margin-top: 10px; 
            text-align: center;
        }
        
        .visitor-card { 
            background: rgba(30, 30, 30, 0.8); 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 10px; 
            border: 1px solid #8a2be2;
            position: relative;
        }
        
        #dataView { 
            display: none; 
            margin-top: 20px; 
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        strong {
            color: #8a2be2;
        }
        
        .checkbox {
            position: absolute;
            top: 10px;
            right: 10px;
            accent-color: #8a2be2;
            width: 18px;
            height: 18px;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .action-buttons button {
            width: auto;
            flex: 1;
        }
        
        #visitsList {
            max-height: 70vh;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        /* Scrollbar styling */
        #visitsList::-webkit-scrollbar {
            width: 8px;
        }
        
        #visitsList::-webkit-scrollbar-track {
            background: rgba(30, 30, 30, 0.5);
            border-radius: 10px;
        }
        
        #visitsList::-webkit-scrollbar-thumb {
            background: #8a2be2;
            border-radius: 10px;
        }
        
        #visitsList::-webkit-scrollbar-thumb:hover {
            background: #9932cc;
        }
        
        .logout-btn {
            background: #ff5555 !important;
            margin-top: 20px;
        }
        
        .logout-btn:hover {
            background: #ff3333 !important;
            box-shadow: 0 0 10px #ff5555 !important;
        }
    </style>
</head>
<body>
    <div class="login-form" id="loginForm">
        <h2>Admin Login</h2>
        <input type="text" id="username" placeholder="Username"><br>
        <input type="password" id="password" placeholder="Password"><br>
        <button onclick="login()">Login</button>
        <p id="loginError" class="error"></p>
    </div>
    
    <div id="dataView">
        <h2>Visitor Records</h2>
        
        <div class="action-buttons">
            <button onclick="deleteSelected()">Delete Selected</button>
            <button onclick="deleteAll()" style="background: #ff5555;">Delete All</button>
        </div>
        
        <div id="visitsList"></div>
        
        <button class="logout-btn" onclick="logout()">Logout</button>
    </div>

    <script>
        // Konfigurasi Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCB_wr4EqhPRzSWQuLgr-eyV9Zisw8_rIs",
            authDomain: "xr-social-53646.firebaseapp.com",
            databaseURL: "https://xr-social-53646-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "xr-social-53646",
            storageBucket: "xr-social-53646.appspot.com",
            messagingSenderId: "55685443011",
            appId: "1:55685443011:web:ef0f9de8e329d24d512176"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Fungsi login
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorMsg = document.getElementById('loginError');
            
            if (!username || !password) {
                errorMsg.textContent = "Username and password required!";
                return;
            }
            
            // Verifikasi admin
            db.ref('adminAccounts').orderByChild('username').equalTo(username).once('value')
                .then(snapshot => {
                    const accounts = snapshot.val();
                    if (accounts) {
                        const accountId = Object.keys(accounts)[0];
                        const account = accounts[accountId];
                        
                        // Verifikasi password
                        if (account.password === password) {
                            // Tampilkan data
                            document.getElementById('loginForm').style.display = 'none';
                            document.getElementById('dataView').style.display = 'block';
                            loadVisitorData();
                        } else {
                            errorMsg.textContent = "Invalid password!";
                        }
                    } else {
                        errorMsg.textContent = "Account not found!";
                    }
                });
        }

        // Fungsi untuk memuat data pengunjung
        function loadVisitorData() {
            db.ref('visits').on('value', (snapshot) => {
                const visits = snapshot.val();
                const container = document.getElementById('visitsList');
                container.innerHTML = '';
                
                if (visits) {
                    Object.keys(visits).forEach(key => {
                        const visit = visits[key];
                        const card = document.createElement('div');
                        card.className = 'visitor-card';
                        card.innerHTML = `
                            <input type="checkbox" class="checkbox" data-key="${key}">
                            <p><strong>IP:</strong> ${visit.ip}</p>
                            <p><strong>Location:</strong> ${visit.city}, ${visit.country}</p>
                            <p><strong>User Agent:</strong> ${visit.userAgent}</p>
                            <p><strong>Time:</strong> ${new Date(visit.timestamp).toLocaleString()}</p>
                        `;
                        container.appendChild(card);
                    });
                } else {
                    container.innerHTML = "<p>No visitor data available</p>";
                }
            });
        }
        
        // Fungsi untuk logout
        function logout() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('dataView').style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('loginError').textContent = '';
        }
        
        // Fungsi untuk menghapus data terpilih
        function deleteSelected() {
            const checkboxes = document.querySelectorAll('.checkbox:checked');
            if (checkboxes.length === 0) {
                alert('Please select at least one record to delete');
                return;
            }
            
            if (confirm(`Are you sure you want to delete ${checkboxes.length} selected records?`)) {
                checkboxes.forEach(checkbox => {
                    const key = checkbox.getAttribute('data-key');
                    db.ref('visits').child(key).remove();
                });
            }
        }
        
        // Fungsi untuk menghapus semua data
        function deleteAll() {
            if (confirm('Are you sure you want to delete ALL records? This cannot be undone!')) {
                db.ref('visits').remove()
                    .then(() => alert('All records have been deleted'))
                    .catch(error => alert('Error deleting records: ' + error.message));
            }
        }
    </script>
</body>
</html>
